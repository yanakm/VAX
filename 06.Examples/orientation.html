<!DOCTYPE html>

<html>
	<head>
		<title>E0905: Ориентация на устройство</title>
		<meta charset="utf-8">
		
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
            #permissionButton{
				position: fixed;
				top: 40%;
				left:30%;
				width: 40%;
				height: 20%;
				background-color: whitesmoke;
				border: 1px solid rgb(214, 214, 214);
				border-radius: 16px;
				cursor: pointer;
			}
        </style>
	</head>
	
	<body>
		<button id="permissionButton" onClick="startOrientation()">Give Permission</button>
		<h2>Orientation</h2>
		<h3>alpha = <span id="alpha"></span></h3>
		<h3>beta = <span id="beta"></span></h3>
		<h3>gamma = <span id="gamma"></span></h3>
		<h3>absolute = <span id="absolute"></span></h3>
		<h2>Motion</h2>
		<h3>acceleration <span id="acceleration1"></span></h3>
		<h3>acc + gravity <span id="acceleration2"></span></h3>
		<script>
			function format(x)
			{
				if (x === null) return 'null';
				return x.toFixed(1);
			}

			function xyz(v)
			{
				return 'X=' + format(v.x) + ' Y=' + format(v.y) + ' Z=' + format(v.z);
			}
			function startOrientation(){
				if(typeof DeviceMotionEvent.requestPermission==='function'){
					DeviceOrientationEvent.requestPermission()
					.then(function(response){
						if(response=='granted'){
							DeviceMotionEvent.requestPermission()
							.then(function(response2){
								if(response2=='granted'){
									alert('Permission granted!');
									window.addEventListener('deviceorientationabsolute',function(event){
									document.getElementById('alpha').innerHTML = event.alpha.toFixed(1);
									document.getElementById('beta').innerHTML = event.beta.toFixed(1);
									document.getElementById('gamma').innerHTML = event.gamma.toFixed(1);
									document.getElementById('absolute').innerHTML = event.absolute.toFixed(1);
								},true);
									window.addEventListener("devicemotion", function(event){
									document.getElementById('acceleration1').innerHTML = xyz(event.acceleration);
									document.getElementById('acceleration2').innerHTML = xyz(event.accelerationIncludingGravity);
									}, true);
								}
								else{
									alert('Access denied');
								}
							})
						}
						else{
							alert('Access denied');
						}
					});
					
				}
				else { alert('Permission not needed')}
				document.getElementById("permissionButton").style.display="none";
			}

		</script>
	</body>
</html>




